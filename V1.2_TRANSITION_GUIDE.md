# v1.2 전환 가이드 📚

## 전환 개요

v1.2는 기존 v1.1의 상태 기반 라우팅을 URL 기반 라우팅으로 전환하는 주요 업데이트입니다. 사용자 경험 개선과 SEO 향상, 그리고 표준적인 웹 네비게이션을 지원합니다.

## 주요 변경사항

### 1. 라우팅 시스템 변경

#### v1.1 (기존)
```javascript
// 상태 기반 뷰 전환
const { setCurrentView } = useSupabaseProjectStore();
setCurrentView('detail');
```

#### v1.2 (신규)
```javascript
// URL 기반 네비게이션
import { useNavigate } from 'react-router-dom';
const navigate = useNavigate();
navigate('/projects/123');
```

### 2. URL 구조

| 기존 뷰 | 새로운 URL | 설명 |
|---------|------------|------|
| `login` | `/login` | 로그인 페이지 |
| `main-dashboard` | `/dashboard` | 메인 대시보드 |
| `list` | `/projects` | 프로젝트 목록 |
| `detail` | `/projects/:id` | 프로젝트 상세 |
| `edit` | `/projects/:id/edit` | 프로젝트 편집 |
| `calendar` | `/calendar` | 달력 페이지 |
| `completed` | `/completed` | 완료된 프로젝트 |
| `admin-dashboard` | `/admin` | 관리자 대시보드 |
| `user-management` | `/admin/users` | 사용자 관리 |
| `audit-log` | `/admin/logs` | 활동 로그 |
| `security-settings` | `/admin/security` | 보안 설정 |

## 마이그레이션 전략

### Phase 1: 병행 운영 (현재)
- v1.1과 v1.2 동시 지원
- 기존 컴포넌트는 `useRouterSync` 훅을 통해 호환성 유지
- 새로운 페이지는 v1.2 구조로 개발

### Phase 2: 점진적 전환
- 페이지별로 v1.2로 순차 마이그레이션
- 기존 기능 유지하면서 구조만 변경
- 충분한 테스트 후 전환

### Phase 3: v1.1 레거시 제거
- 모든 페이지가 v1.2로 전환 완료 후
- 기존 AppRouter 및 상태 기반 라우팅 제거
- 코드 정리 및 최적화

## 개발자 가이드

### 새로운 페이지 개발 시

1. **페이지 컴포넌트 생성**
```javascript
// src/pages/YourPage/YourPage_v1.2.jsx
import React from 'react';
import { useParams, useNavigate } from 'react-router-dom';

const YourPage_v1_2 = () => {
  const { id } = useParams(); // URL 파라미터 사용
  const navigate = useNavigate(); // 네비게이션 사용
  
  return (
    <div>
      {/* 페이지 내용 */}
    </div>
  );
};

export default YourPage_v1_2;
```

2. **App_v1.2.jsx에 라우트 추가**
```javascript
<Route path="/your-path/:id" element={
  <ProtectedRoute>
    <Layout>
      <YourPage />
    </Layout>
  </ProtectedRoute>
} />
```

### 기존 컴포넌트 마이그레이션

1. **네비게이션 코드 변경**
```javascript
// 변경 전
const { setCurrentView } = useSupabaseProjectStore();
const handleClick = () => {
  setCurrentView('detail');
};

// 변경 후
import { useNavigate } from 'react-router-dom';
const navigate = useNavigate();
const handleClick = () => {
  navigate('/projects/123');
};
```

2. **링크 컴포넌트 사용**
```javascript
// 변경 전
<button onClick={() => setCurrentView('detail')}>
  프로젝트 보기
</button>

// 변경 후
import { Link } from 'react-router-dom';
<Link to="/projects/123" className="button-styles">
  프로젝트 보기
</Link>
```

3. **URL 파라미터 사용**
```javascript
// 변경 전
const { selectedProject } = useSupabaseProjectStore();

// 변경 후
import { useParams } from 'react-router-dom';
const { id: projectId } = useParams();
// 필요시 프로젝트 데이터를 별도로 로드
```

## 호환성 유지

### useRouterSync 훅 사용
기존 v1.1 컴포넌트가 v1.2 환경에서 동작하도록 도와주는 훅입니다.

```javascript
import { useRouterSync } from '../hooks/useRouterSync';

const LegacyComponent = () => {
  const { currentView, navigateToView } = useRouterSync();
  
  // 기존 코드 그대로 사용 가능
  const handleNavigation = () => {
    navigateToView('detail', projectId);
  };
};
```

### useCompatRouter 훅 사용
기존 컴포넌트에서 최소한의 변경으로 v1.2 호환성을 확보합니다.

```javascript
import { useCompatRouter } from '../hooks/useRouterSync';

const LegacyComponent = () => {
  const { setCurrentView } = useCompatRouter();
  
  // 기존 코드와 동일하게 사용하면 자동으로 URL이 변경됨
  const handleClick = () => {
    setCurrentView('detail');
  };
};
```

## 테스트 방법

### 1. 기능 테스트
- [ ] 각 URL로 직접 접근 가능
- [ ] 브라우저 뒤로가기/앞으로가기 동작
- [ ] 페이지 새로고침 시 상태 유지
- [ ] 인증 보호 동작 확인

### 2. 호환성 테스트  
- [ ] 기존 v1.1 컴포넌트 정상 동작
- [ ] 데이터 공유 정상 동작
- [ ] 상태 동기화 정상 동작

### 3. 성능 테스트
- [ ] 초기 로딩 시간
- [ ] 페이지 전환 속도
- [ ] 메모리 사용량

## 배포 계획

### 단계 1: 베타 배포 (1주)
- v1.2 기본 구조 배포
- 로그인 및 대시보드 페이지 테스트
- 피드백 수집

### 단계 2: 점진적 롤아웃 (2주)
- 프로젝트 관련 페이지 순차 전환
- 사용자 피드백 반영
- 버그 수정

### 단계 3: 완전 전환 (1주)
- 모든 페이지 v1.2로 전환
- 레거시 코드 제거
- 성능 최적화

## 주의사항

1. **데이터 호환성**: 기존 localStorage 데이터 구조 유지
2. **인증 시스템**: 기존 Supabase 인증 그대로 사용
3. **상태 관리**: Context API 구조 유지
4. **UI 컴포넌트**: 기존 UI 컴포넌트 재사용

## 롤백 계획

문제 발생 시 즉시 v1.1으로 롤백 가능하도록:
- App.jsx에서 App_v1.2.jsx 대신 AuthenticatedApp_v1.1.jsx 사용
- 기존 코드는 삭제하지 않고 유지
- 데이터 구조는 변경하지 않음

## 기대 효과

1. **사용자 경험 개선**
   - 브라우저 네비게이션 지원
   - 북마크 및 링크 공유 가능
   - 페이지 새로고침 시 상태 유지

2. **개발 생산성 향상**
   - 페이지별 독립적 개발
   - 명확한 라우팅 구조
   - 디버깅 용이성

3. **SEO 및 접근성**
   - 검색 엔진 최적화
   - 직접 URL 접근 가능
   - 표준 웹 네비게이션 지원

이 가이드를 참고하여 단계적으로 v1.2로 전환해주시기 바랍니다.